# HSE_ML_HW1

## Обработка датасета
У нас есть 2 датасета (обучающий и тестовый), включающие 13 признаков по характеристикам автомобилей. Цель - предсказать стоимость автомобиля. 
Размер обучающей выборки 6999 объектов, тестовой - 1000  объектов.

* В выборках присутствовали дубликаты и пропуски. Дубликаты удалили, пропуски заполнили медианой по столбцу в обучающей выборке.
* Предобработали текстовые столбцы, содержащие информацию о мощности и объеме двигателя, расходе топлива, крутящем моменте и кол-ве оборотов. Привели эти признаки к числовому формату и единым единицам измерения.
* Аналитически исследовали связи между признаками с помощью pairplot, корреляций (Пирсона и Спирмена), phik. Подробное описание - в ноутбуке.

## Обучение моделей
* На вещественных признаках обучили линейную регрессию, Lasso- и Elastic-регрессию. Перед обучением признаки масштабировали, гиперпараметры подбирали через GridSearchCV.
Лучший результат на вещественных признаках получили на модели Elastic с `alpha` = 0.55`, `l1_ratio = 0.9`. R^2 на тестовой выборке составил 0.587, MSE 237397095613, бизнес-метрика 0.251 (доля прогнозов, отличающихся от реальных цен на эти авто не более чем на 10%).

* С помощью MeanTargetEncoding закодировали название автомобиля, а через One-Hot Oncoding закодировали категориальные признаки. Подобрали гиперпараметры для  Ridge-регрессии: `alpha=200`. R^2 на тестовой выборке составил 0.755, MSE 40287611095, бизнес-метрика 0.206. Несмотря на прирост в R^2 и MSE значение бизнес-метрики упало, поэтому от категориальных признаков решили отказаться.

* Для повышения точности предсказаний пробовали очистить обучающую выборку от выбросов, добавить в признаки удельную мощность, объединить категории в категориальных признаках, возвести в квадрат год и пробег. Качество предсказаний упало, поэтому от этих методов отказались.

* Для всех вещественных признаков добавили полиномизацию до 2-ой степени, а затем масштаировали. Подобрали гиперпараметры для Elastic и Ridge-регрессий. Результат резко вырос. Обе модели показали примерно одинаковую точность. На модели Elastic с параметрами `alpha: 0.75`, `l1_ratio': 0.95` получили R^2 на тесте 0.873, MSE 72691855356, бизнес-метрику 0.304. На основе данной модели и способа предобработки сделал сервис FastAPI.

